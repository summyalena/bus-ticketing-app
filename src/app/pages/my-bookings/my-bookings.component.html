<div class="bookings-page">
  <div class="bookings-header">
    <div class="header-content">
      <h1>
        <i class="fas fa-ticket-alt"></i>
        My Bookings
      </h1>
      <p>View and manage all your bus ticket bookings</p>
    </div>
  </div>

  <div class="bookings-container">
    <!-- Filter Tabs -->
    <div class="filter-tabs">
      <button 
        class="tab"
        [class.active]="selectedFilter() === 'all'"
        (click)="filterBookings('all')"
      >
        <i class="fas fa-list"></i>
        All Bookings
        <span class="count">{{ bookings().length }}</span>
      </button>
      <button 
        class="tab"
        [class.active]="selectedFilter() === 'upcoming'"
        (click)="filterBookings('upcoming')"
      >
        <i class="fas fa-clock"></i>
        Upcoming
      </button>
      <button 
        class="tab"
        [class.active]="selectedFilter() === 'completed'"
        (click)="filterBookings('completed')"
      >
        <i class="fas fa-check-circle"></i>
        Completed
      </button>
    </div>

    @if (isLoading()) {
      <div class="loading-state">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Loading your bookings...</p>
      </div>
    }

    <!-- Empty State -->
    @else if (filteredBookings.length === 0) {
      <div class="empty-state">
        <i class="fas fa-inbox"></i>
        <h3>No bookings found</h3>
        <p>You haven't made any bookings yet</p>
        <button class="btn-search" (click)="router.navigate(['/search'])">
          <i class="fas fa-search"></i>
          Search Buses
        </button>
      </div>
    }

    <!-- Bookings List -->
    @else {
      <div class="bookings-list">
        @for (booking of filteredBookings; track booking.bookingId) {
          <div class="booking-card">
            <div class="booking-header">
              <div class="booking-id">
                <span class="label">Booking ID:</span>
                <span class="value">#{{ booking.bookingId }}</span>
              </div>
              <div class="booking-date">
                <i class="fas fa-calendar-alt"></i>
                {{ formatDate(booking.bookingDate) }}
              </div>
            </div>

            <div class="booking-body">
              <div class="journey-info">
                <div class="route">
                  <div class="location from">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>From Location</span>
                  </div>
                  <div class="arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="location to">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>To Location</span>
                  </div>
                </div>
              </div>

              <div class="passengers-section">
                <h4>
                  <i class="fas fa-users"></i>
                  Passengers ({{ booking.busBookingPassengers.length }})
                </h4>
                <div class="passengers-list">
                  @for (passenger of booking.busBookingPassengers; track passenger.passengerId) {
                    <div class="passenger-item">
                      <div class="passenger-info">
                        <i class="fas fa-user-circle"></i>
                        <span class="name">{{ passenger.passengerName }}</span>
                        <span class="details">{{ passenger.age }} yrs, {{ passenger.gender }}</span>
                      </div>
                      <div class="seat-info">
                        <i class="fas fa-chair"></i>
                        Seat {{ passenger.seatNo }}
                      </div>
                    </div>
                  }
                </div>
              </div>
            </div>

            <div class="booking-footer">
              <button 
                class="btn-view" 
                (click)="viewBookingDetails(booking.bookingId)"
              >
                <i class="fas fa-eye"></i>
                View Details
              </button>
              <button 
                class="btn-cancel" 
                (click)="cancelBooking(booking.bookingId)"
              >
                <i class="fas fa-times-circle"></i>
                Cancel Booking
              </button>
            </div>
          </div>
        }
      </div>
    }
  </div>
</div>